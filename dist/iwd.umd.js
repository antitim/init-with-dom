!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).iwd=t()}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var a=function(e,t){for(var n=0;e.length>n;n++)t(e[n],n)},d=function(e){return e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})},u=function t(){var r=this;e(this,t),n(this,"executeHandler",function(e){var t=r.handlers[e],n=r.nodes[e];n&&t&&a(n,function(e){return r.init(e,t)})}),n(this,"init",function(e,t){if(!e.classList.contains("js_inited")){var n=function(e){for(var t={data:{}},n=0;e.attributes.length>n;n++){var r=e.attributes[n].name,o=e.attributes[n].textContent;"data"===r.slice(0,4)?(r=r.slice(5),r=d(r),t.data[r]=o):t[r=d(r)]=o}return t}(e),o=!0,i=!1,a=void 0;try{for(var u,s=r.middleware[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){n=(0,u.value)(e,n)}}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}t.call(e,n),e.classList.add("js_inited")}}),n(this,"addNode",function(e){if(e.getAttribute){var t=e.getAttribute("data-js");t&&(e.classList.add("js"),r.nodes[t]||(r.nodes[t]=[]),r.nodes[t].push(e),r.executeHandler(t))}}),n(this,"removedUnusedNode",function(){for(var e=Object.keys(r.nodes),t=0;e.length>t;t++){var n=e[t];r.nodes[n]=r.nodes[n].filter(function(e){return e.isConnected})}}),n(this,"addHandler",function(e,t){r.handlers[e]=t,r.executeHandler(e)}),n(this,"replaceHandler",function(e,t){r.handlers[e]=t}),n(this,"removeHandler",function(e){r.handlers[e]=null}),n(this,"removeAllHandlers",function(){r.handlers={}}),this.nodes={},this.handlers={},this.middleware=[]},s=function(e,t,n){var r;try{r=new CustomEvent(t,{detail:n})}catch(e){(r=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,n)}e.dispatchEvent(r)},c=function(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver},l=new(function(d){function l(t){var o,d,u;return e(this,l),d=this,u=r(l).call(this,t),o=!u||"object"!=typeof u&&"function"!=typeof u?i(d):u,n(i(i(o)),"mutationCallback",function(e){e.forEach(function(e){"childList"===e.type&&a(e.addedNodes,function(e){o.addNode(e),e.querySelectorAll&&a(e.querySelectorAll("[data-js]"),o.addNode)});"attributes"===e.type&&s(e.target,"iwdUpdate",{attribute:e.attributeName})})}),a(document.querySelectorAll("[data-js]"),o.addNode),o.Observer=c(),o.attachEvent(),o}var f,h,v;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(l,u),f=l,(h=[{key:"attachEvent",value:function(){var e=this;this.Observer?new this.Observer(this.mutationCallback).observe(document.body,{childList:!0,attributes:!0,subtree:!0}):(document.addEventListener("DOMNodeInserted",function(t){t.target.constructor!==NodeList?e.addNode(t.target):a(t.target,e.addNode)},!1),document.addEventListener("DOMAttrModified",function(e){s(e.target,"iwdUpdate",{attribute:e.attrName})},!1))}}])&&t(f.prototype,h),v&&t(f,v),l}());return{add:l.addHandler,replace:l.replaceHandler,remove:l.removeHandler,removeAll:l.removeAllHandlers,middleware:l.middleware}});
//# sourceMappingURL=iwd.umd.js.map
